<!DOCTYPE html>
<html>
<head>
  <title>DevGenie Login</title>
  <!-- Use Firebase v8 (namespaced version) -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <style>
    #status { 
      margin-top: 10px; 
      color: red; 
      word-wrap: break-word; 
    }
  </style>
</head>
<body>
  <h2>Login to DevGenie</h2>
  <button onclick="login()">Sign in with Google</button>
  <div id="status">Status: Waiting for click...</div>

  <script>
    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCH0Wwx97ymQxeD08yoDKw3i1QOf_hEwng",
      authDomain: "dev-genie-e4ede.firebaseapp.com",
      projectId: "dev-genie-e4ede",
      appId: "1:390698821035:web:f2b6c5550a9f8847741eee"
    };

    // Initialize Firebase
    try {
      firebase.initializeApp(firebaseConfig);
      updateStatus("Firebase initialized successfully");
    } catch (error) {
      updateStatus("Firebase init failed: " + error.message);
    }

    const auth = firebase.auth();
    const provider = new firebase.auth.GoogleAuthProvider();

    function updateStatus(message) {
      document.getElementById("status").innerText = "Status: " + message;
    }

    function login() {
      updateStatus("Login button clicked, attempting sign-in...");
      auth.signInWithRedirect(provider)
        .catch((error) => {
          updateStatus("Sign-in failed: " + error.message);
        });
    }

    auth.getRedirectResult()
      .then((result) => {
        if (result.user) {
          updateStatus("Sign-in successful, getting token...");
          result.user.getIdToken().then((token) => {
            updateStatus("Token: " + token);
            alert("Copy this token and paste in terminal:\n\n" + token);
          });
        }
      })
      .catch((error) => {
        updateStatus("Redirect result failed: " + error.message);
      });
  </script>
</body>
</html>
